# -*- mode: ruby -*-
# vi: set ft=ruby :

$init = <<SCRIPT
sudo /home/vagrant/android-sdk-linux/platform-tools/adb kill-server
sudo /home/vagrant/android-sdk-linux/platform-tools/adb start-server
sudo /home/vagrant/android-sdk-linux/platform-tools/adb devices
SCRIPT


Vagrant.configure(2) do |config|

  config.vm.box = "ubuntu/trusty32"

  config.vm.network "forwarded_port", guest: 3000, host: 3000
  
  config.vm.synced_folder ".", "/home/vagrant/dev"

  config.vm.provider :virtualbox do |v|
    v.name = "gr"
    v.memory = 1024
    v.cpus = 2
    v.customize ["modifyvm", :id, "--natdnshostresolver1", "on"]
    v.customize ["modifyvm", :id, "--ioapic", "on"]
    v.customize ["modifyvm", :id, "--usb", "on"]
    v.customize ["usbfilter", "add", "0", "--target", :id, "--name", "android", "--vendorid", "0x18d1"]
  end

  config.vm.hostname = "gr"
  config.vm.network :private_network, ip: "192.168.33.27"

  config.vm.define :gr do |gr|
  end

# config.vm.provision :shell, path: "bootstrap.sh"
  config.vm.provision :shell, run: "always", inline: $init


   config.vm.provision "ansible" do |ansible|
     ansible.playbook = "provisioning/playbook.yml"
     ansible.inventory_path = "provisioning/inventory"
     ansible.sudo = true
   end
end
